(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),r=n.n(s),l=n(14),o=n.n(l),i=(n(30),n(31),n(32),n(8)),c=n(2),d=n(9),h=n(10),j=n(4),u=n(12),b=n(11),p=n(23),m=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={username:null,loggedIn:!!localStorage.getItem("token")},e.handleLogout=e.handleLogout.bind(Object(j.a)(e)),e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){if(this.state.loggedIn){var e=localStorage.getItem("token"),t=Object(p.a)(e);this.setState({username:t.username})}}},{key:"handleLogout",value:function(){localStorage.removeItem("token"),this.setState({loggedIn:!1,username:null})}},{key:"render",value:function(){var e=this.state.username;return Object(a.jsxs)("nav",{children:[Object(a.jsx)(i.b,{to:"/",children:"Home"}),e?Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:e}),Object(a.jsx)("li",{onClick:this.handleLogout,children:Object(a.jsx)(i.b,{children:"Log out"})})]}):Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)(i.b,{to:"/register",children:"Register"})}),Object(a.jsx)("li",{children:Object(a.jsx)(i.b,{to:"/login",children:"Log in"})})]})]})}}]),n}(r.a.Component),O=n(21),g=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={pollList:null},e.updatePoll=e.updatePoll.bind(Object(j.a)(e)),e.handleClick=e.handleClick.bind(Object(j.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(j.a)(e)),e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("http://127.0.0.1:8000/api/poll-list/").then((function(e){return e.json()})).then((function(t){return e.setState({pollList:t})}))}},{key:"updatePoll",value:function(e){var t=this;e.preventDefault();var n=o.a.findDOMNode(e.target).parentNode.parentNode.getAttribute("id"),a=this.state.pollList[n];a[e.target.name]=a[e.target.name]+1,fetch("http://127.0.0.1:8000/api/update/".concat(a.id,"/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){var a=Object(O.a)(t.state.pollList);a[n]=e,t.setState({pollList:a})}))}},{key:"handleClick",value:function(e){this.updatePoll(e),e.target.classList.add("active"),console.log(e.target.nextElementSibling),o.a.findDOMNode(e.target).parentNode.parentNode.classList.add("voted"),o.a.findDOMNode(e.target).parentNode.querySelectorAll("button").forEach((function(e){return e.disabled=!0}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),fetch("http://127.0.0.1:8000/api/create-poll/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.target.querySelector("#form-title").value,option1:e.target.querySelector("#form-option1").value,option2:e.target.querySelector("#form-option2").value})}).then((function(e){return e.json()})).then((function(e){t.setState({pollList:[].concat(Object(O.a)(t.state.pollList),[e])})}))}},{key:"render",value:function(){var e=this,t=this.state.pollList;try{return Object(a.jsxs)("div",{children:[!localStorage.getItem("token")&&Object(a.jsx)("div",{className:"login-statement",children:Object(a.jsx)("h1",{children:"Log in to vote and create polls"})}),localStorage.getItem("token")&&Object(a.jsxs)("div",{className:"poll-create",children:[Object(a.jsx)("h1",{children:"Create a poll: "}),Object(a.jsxs)("form",{onSubmit:this.handleSubmit,className:"poll-form",children:[Object(a.jsx)("input",{style:{flex:3},type:"text",id:"form-title",placeholder:"Create a poll"}),Object(a.jsx)("input",{style:{flex:3},type:"text",id:"form-option1",placeholder:"Option 1"}),Object(a.jsx)("input",{style:{flex:3},type:"text",id:"form-option2",placeholder:"Option 2"}),Object(a.jsx)("input",{style:{flex:1},type:"submit",id:"form-submit",placeholder:"Submit"})]})]}),Object(a.jsx)("div",{className:"polls",children:t.map((function(n){return Object(a.jsxs)("div",{className:"poll",id:t.indexOf(n),children:[Object(a.jsx)("h1",{className:"poll-title",children:n.title}),Object(a.jsxs)("div",{className:"poll-options",children:[Object(a.jsx)("button",{onClick:e.handleClick,name:"option1total",className:"poll-button",disabled:!localStorage.getItem("token"),children:n.option1}),Object(a.jsx)("button",{onClick:e.handleClick,name:"option2total",className:"poll-button",disabled:!localStorage.getItem("token"),children:n.option2})]}),Object(a.jsxs)("div",{className:"poll-results",children:[Object(a.jsx)("p",{children:"Total votes: "}),Object(a.jsx)("div",{className:"votes-container",children:Object(a.jsxs)("div",{className:"votes",children:[Object(a.jsx)("p",{children:n.option1total}),Object(a.jsx)("p",{children:n.option2total})]})})]})]})}))})]})}catch(n){return Object(a.jsx)("h1",{children:"Loading..."})}}}]),n}(r.a.Component);var x=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(m,{}),Object(a.jsx)(g,{})]})},f=n(16),v=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={username:null,password:null,redirect:!1,error:!1},e.handleSubmit=e.handleSubmit.bind(Object(j.a)(e)),e.handleChange=e.handleChange.bind(Object(j.a)(e)),e}return Object(h.a)(n,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),fetch("http://127.0.0.1:8000/api/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})}).then((function(e){return e.json()})).then((function(e){e.token?(localStorage.setItem("token",e.token),t.setState({redirect:!0})):t.setState({error:!0})}))}},{key:"handleChange",value:function(e){e.preventDefault(),this.setState(Object(f.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return this.state.redirect?Object(a.jsx)(c.a,{to:"/"}):Object(a.jsxs)("div",{children:[Object(a.jsx)(m,{}),Object(a.jsxs)("div",{className:"register-container",children:[Object(a.jsx)("h1",{children:"REGISTER"}),this.state.error&&Object(a.jsx)("h2",{className:"register-error",children:"Username already exists!"}),Object(a.jsx)("div",{className:"form-container",children:Object(a.jsxs)("form",{onSubmit:this.handleSubmit,className:"register-form",children:[Object(a.jsx)("input",{type:"text",name:"username",onChange:this.handleChange,placeholder:"Username"}),Object(a.jsx)("input",{type:"password",name:"password",onChange:this.handleChange,placeholder:"Password"}),Object(a.jsx)("div",{className:"register-form-submit",children:Object(a.jsx)("input",{type:"submit",value:"REGISTER"})})]})})]})]})}}]),n}(r.a.Component),S=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={username:null,password:null,loggedin:!1,error:!1},e.handleSubmit=e.handleSubmit.bind(Object(j.a)(e)),e.handleChange=e.handleChange.bind(Object(j.a)(e)),e}return Object(h.a)(n,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),fetch("http://127.0.0.1:8000/api/token-auth/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})}).then((function(e){return e.json()})).then((function(e){try{e.user.username&&(localStorage.setItem("token",e.token),localStorage.setItem("user",e.user.username),t.setState({loggedin:!0}))}catch(n){t.setState({error:!0})}}))}},{key:"handleChange",value:function(e){e.preventDefault(),this.setState(Object(f.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return this.state.loggedin?Object(a.jsx)(c.a,{to:"/"}):Object(a.jsxs)("div",{children:[Object(a.jsx)(m,{}),Object(a.jsxs)("div",{className:"register-container",children:[Object(a.jsx)("h1",{children:"LOG IN"}),this.state.error&&Object(a.jsx)("h2",{className:"register-error",children:"Username already exists!"}),Object(a.jsx)("div",{className:"form-container",children:Object(a.jsxs)("form",{onSubmit:this.handleSubmit,className:"register-form",children:[Object(a.jsx)("input",{type:"text",name:"username",onChange:this.handleChange,placeholder:"Username"}),Object(a.jsx)("input",{type:"password",name:"password",onChange:this.handleChange,placeholder:"Password"}),Object(a.jsx)("div",{className:"register-form-submit",children:Object(a.jsx)("input",{type:"submit",value:"LOG IN"})})]})})]})]})}}]),n}(r.a.Component),y=!!localStorage.getItem("token");o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(i.a,{children:Object(a.jsxs)(c.d,{children:[Object(a.jsx)(c.b,{exact:!0,path:"/",component:x}),Object(a.jsx)(c.b,{exact:!0,path:"/register",component:v,children:y&&Object(a.jsx)(c.a,{to:"/"})}),Object(a.jsx)(c.b,{exact:!0,path:"/login",component:S,children:y&&Object(a.jsx)(c.a,{to:"/"})})]})})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.bad912ee.chunk.js.map