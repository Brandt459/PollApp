{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import ReactDOM from'react-dom';var Polls=/*#__PURE__*/function(_React$Component){_inherits(Polls,_React$Component);var _super=_createSuper(Polls);function Polls(){var _this;_classCallCheck(this,Polls);_this=_super.call(this);_this.state={pollList:null};_this.updatePoll=_this.updatePoll.bind(_assertThisInitialized(_this));_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(Polls,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('http://127.0.0.1:8000/api/poll-list/').then(function(response){return response.json();}).then(function(data){return _this2.setState({pollList:data});});}},{key:\"updatePoll\",value:function updatePoll(e){var _this3=this;e.preventDefault();var index=ReactDOM.findDOMNode(e.target).parentNode.parentNode.getAttribute(\"id\");var poll=this.state.pollList[index];poll[e.target.name]=poll[e.target.name]+1;fetch(\"http://127.0.0.1:8000/api/update/\".concat(poll[\"id\"],\"/\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(poll)}).then(function(response){return response.json();}).then(function(data){var polls=_toConsumableArray(_this3.state.pollList);polls[index]=data;_this3.setState({pollList:polls});});}},{key:\"handleClick\",value:function handleClick(e){this.updatePoll(e);e.target.classList.add(\"active\");console.log(e.target.nextElementSibling);ReactDOM.findDOMNode(e.target).parentNode.parentNode.classList.add(\"voted\");var buttons=ReactDOM.findDOMNode(e.target).parentNode.querySelectorAll('button');buttons.forEach(function(button){return button.disabled=true;});}},{key:\"handleSubmit\",value:function handleSubmit(e){var _this4=this;e.preventDefault();fetch('http://127.0.0.1:8000/api/create-poll/',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({\"title\":e.target.querySelector(\"#form-title\").value,\"option1\":e.target.querySelector(\"#form-option1\").value,\"option2\":e.target.querySelector(\"#form-option2\").value})}).then(function(response){return response.json();}).then(function(data){_this4.setState({pollList:[].concat(_toConsumableArray(_this4.state.pollList),[data])});});}},{key:\"render\",value:function render(){var _this5=this;var pollList=this.state.pollList;try{return/*#__PURE__*/_jsxs(\"div\",{children:[!localStorage.getItem('token')&&/*#__PURE__*/_jsx(\"div\",{className:\"login-statement\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Log in to vote and create polls\"})}),localStorage.getItem('token')&&/*#__PURE__*/_jsxs(\"div\",{className:\"poll-create\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Create a poll: \"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,className:\"poll-form\",children:[/*#__PURE__*/_jsx(\"input\",{style:{flex:3},type:\"text\",id:\"form-title\",placeholder:\"Create a poll\"}),/*#__PURE__*/_jsx(\"input\",{style:{flex:3},type:\"text\",id:\"form-option1\",placeholder:\"Option 1\"}),/*#__PURE__*/_jsx(\"input\",{style:{flex:3},type:\"text\",id:\"form-option2\",placeholder:\"Option 2\"}),/*#__PURE__*/_jsx(\"input\",{style:{flex:1},type:\"submit\",id:\"form-submit\",placeholder:\"Submit\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"polls\",children:pollList.map(function(poll){return/*#__PURE__*/_jsxs(\"div\",{className:\"poll\",id:pollList.indexOf(poll),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"poll-title\",children:poll[\"title\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"poll-options\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:_this5.handleClick,name:\"option1total\",className:\"poll-button\",disabled:!localStorage.getItem('token'),children:poll[\"option1\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:_this5.handleClick,name:\"option2total\",className:\"poll-button\",disabled:!localStorage.getItem('token'),children:poll[\"option2\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"poll-results\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Total votes: \"}),/*#__PURE__*/_jsx(\"div\",{className:\"votes-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"votes\",children:[/*#__PURE__*/_jsx(\"p\",{children:poll[\"option1total\"]}),/*#__PURE__*/_jsx(\"p\",{children:poll[\"option2total\"]})]})})]})]});})})]});}catch(_unused){return/*#__PURE__*/_jsx(\"h1\",{children:\"Loading...\"});}}}]);return Polls;}(React.Component);export default Polls;","map":{"version":3,"sources":["C:/Users/Brand/Dev/VotingApp/VotingApp/frontend/src/components/Polls.js"],"names":["React","ReactDOM","Polls","state","pollList","updatePoll","bind","handleClick","handleSubmit","fetch","then","response","json","data","setState","e","preventDefault","index","findDOMNode","target","parentNode","getAttribute","poll","name","method","headers","body","JSON","stringify","polls","classList","add","console","log","nextElementSibling","buttons","querySelectorAll","forEach","button","disabled","querySelector","value","localStorage","getItem","flex","map","indexOf","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\n\nclass Polls extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      pollList: null,\n    }\n    this.updatePoll = this.updatePoll.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  componentDidMount() {\n    fetch('http://127.0.0.1:8000/api/poll-list/')\n      .then(response => response.json())\n      .then(data =>\n        this.setState({ pollList: data }))\n  }\n\n  updatePoll(e) {\n    e.preventDefault()\n    const index = ReactDOM.findDOMNode(e.target).parentNode.parentNode.getAttribute(\"id\")\n    let poll = this.state.pollList[index]\n    poll[e.target.name] = poll[e.target.name] + 1\n    fetch(`http://127.0.0.1:8000/api/update/${poll[\"id\"]}/`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(poll)\n    })\n      .then(response => response.json())\n      .then(data => {\n        let polls = [...this.state.pollList]\n        polls[index] = data\n        this.setState({\n          pollList: polls\n        })\n      })\n  }\n\n  handleClick(e) {\n    this.updatePoll(e)\n    e.target.classList.add(\"active\")\n    console.log(e.target.nextElementSibling)\n    ReactDOM.findDOMNode(e.target).parentNode.parentNode.classList.add(\"voted\")\n    const buttons = ReactDOM.findDOMNode(e.target).parentNode.querySelectorAll('button')\n    buttons.forEach(button => button.disabled = true)\n  }\n\n  handleSubmit(e) {\n    e.preventDefault()\n    fetch('http://127.0.0.1:8000/api/create-poll/', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        \"title\": e.target.querySelector(\"#form-title\").value,\n        \"option1\": e.target.querySelector(\"#form-option1\").value,\n        \"option2\": e.target.querySelector(\"#form-option2\").value\n      })\n    })\n      .then(response => response.json())\n      .then(data => {\n        this.setState({\n          pollList: [...this.state.pollList, data]\n        })\n      })\n  }\n\n  render() {\n    const pollList = this.state.pollList\n    try {\n      return (\n        <div>\n          {!localStorage.getItem('token') &&\n            <div className=\"login-statement\">\n              <h1>Log in to vote and create polls</h1>\n            </div>\n          }\n          {localStorage.getItem('token') &&\n            <div className=\"poll-create\">\n              <h1>Create a poll: </h1>\n              <form onSubmit={this.handleSubmit} className=\"poll-form\">\n                <input style={{ flex: 3 }} type=\"text\" id=\"form-title\" placeholder=\"Create a poll\" />\n                <input style={{ flex: 3 }} type=\"text\" id=\"form-option1\" placeholder=\"Option 1\" />\n                <input style={{ flex: 3 }} type=\"text\" id=\"form-option2\" placeholder=\"Option 2\" />\n                <input style={{ flex: 1 }} type=\"submit\" id=\"form-submit\" placeholder=\"Submit\" />\n              </form>\n            </div>\n          }\n          <div className=\"polls\">\n            {pollList.map(poll => {\n              return (\n                <div className=\"poll\" id={pollList.indexOf(poll)}>\n                  <h1 className=\"poll-title\">{poll[\"title\"]}</h1>\n                  <div className=\"poll-options\">\n                    <button onClick={this.handleClick} name=\"option1total\" className=\"poll-button\" disabled={!localStorage.getItem('token')}>{poll[\"option1\"]}</button>\n                    <button onClick={this.handleClick} name=\"option2total\" className=\"poll-button\" disabled={!localStorage.getItem('token')}>{poll[\"option2\"]}</button>\n                  </div>\n                  <div className=\"poll-results\">\n                    <p>Total votes: </p>\n                    <div className=\"votes-container\">\n                      <div className=\"votes\">\n                        <p>{poll[\"option1total\"]}</p>\n                        <p>{poll[\"option2total\"]}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div >\n      )\n    } catch {\n      return <h1>Loading...</h1>\n    }\n  }\n}\n\n\n\nexport default Polls;\n"]},"metadata":{},"sourceType":"module"}